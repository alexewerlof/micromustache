#!/usr/bin/env node

// tslint:disable-next-line no-var-requires
const fs = require('fs')
// tslint:disable-next-line no-var-requires
const { render } = require('../lib/')
const encoding = 'utf8'

// eslint-disable-next-line no-unused-vars
const [, scriptName, templatePath, viewPath] = process.argv

const syntax = `${scriptName} templatePath viewPath
Both parameters are required.
  templatePath: path to a template text file that contains {{varName}} in it
  viewPath: path to a valid json file
By default this script prints to console. You can redirect it to output file using '> outputPath'
Files are read/write with utf8 encoding.`

try {
  const template = fs.readFileSync(templatePath, { encoding })
  const viewTxt = fs.readFileSync(viewPath, { encoding })
  const view = JSON.parse(viewTxt)
  // tslint:disable-next-line no-console
  console.log(render(template, view))
} catch (e) {
  // tslint:disable-next-line no-console
  console.error(syntax)
  throw e
}
